@* THIS FILE IS NOT IN USE *@
@model Nucleus.Modules.Account.ViewModels.VerifyOtp
@addTagHelper "*, Nucleus.ViewFeatures"
@using Nucleus.ViewFeatures
@using Nucleus.ViewFeatures.HtmlHelpers
@Html.AddStyle(AddStyleHtmlHelper.WellKnownScripts.NUCLEUS_FORMS)
@using (Html.BeginNucleusForm("VerifyOtp", "Login", "Account", FormMethod.Post, new { data_target = "form.parent()" }))
{
  <fieldset aria-label="Two-Step Verification">
    @if (!String.IsNullOrEmpty(Model.Message))
    {
      <div class="alert alert-warning">@Model.Message</div>
    }
    @Html.HiddenFor(model => model.ReturnUrl)
    @Html.HiddenFor(model => model.SessionId)
    <div>For added security, please enter the One Time Password (OTP) generated by your Authenticator App.</div>
    <div>
      <label>
        <span>Enter OTP:</span>
        <span>@Html.TextBoxFor(model => model.OneTimePassword, new { @size = "6", @type = "text", @inputmode = "numeric" })</span>
      </label>
    </div>

    <div class="m-5">@Html.Raw(Model.QrCodeAsSvg)</div>

  </fieldset>
  <div class="account-buttons-wrapper">
    <div class="mt-2 account-main-buttons">
      <button type="submit" class="btn btn-primary nucleus-login" data-target="form.parent()">Confirm</button>
      <a href="@Url.Content("~/")" class="btn btn-secondary">Cancel</a>
    </div>
  </div>
}
<script>
  jQuery(function ()
  {
    jQuery(Page).on('ready', function (page, target, data, url, event, status, request)
    {
      jQuery('#@(nameof(Nucleus.Modules.Account.ViewModels.VerifyOtp.OneTimePassword))')
        .siblings('.nucleus-progress-spinner')
        .remove();
    });

    jQuery('.nucleus-login').on('click', function ()
    {
      var usernameControl = jQuery('#@(nameof(Nucleus.Modules.Account.ViewModels.VerifyOtp.OneTimePassword))');

      if (usernameControl.siblings('.nucleus-progress-spinner').length === 0)
      {
        var progress = jQuery('<div class="spinner-border spinner-border-sm text-primary nucleus-progress-spinner ms-2 mt-1 position-absolute" role="status"/>');
        progress.insertAfter(usernameControl);
      }
    });
  });
</script>