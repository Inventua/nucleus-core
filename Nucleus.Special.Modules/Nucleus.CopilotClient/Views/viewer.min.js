(function(){jQuery.fn.CopilotViewer=function(n){function e(){t();f=!0}function t(){h();i=window.setTimeout(o,r.interval)}function o(){var n=u.parents("form").first();jQuery.ajax({url:r.url,"async":!0,method:"POST",enctype:n.attr("enctype"),data:n.attr("enctype")==="multipart/form-data"?new FormData(n[0]):n.serialize(),headers:{Accept:"application/json, */*"},processData:n.attr("enctype")==="multipart/form-data"?!1:!0,contentType:n.attr("enctype")==="multipart/form-data"?!1:"application/x-www-form-urlencoded; charset=UTF-8",success:function(i,r){r!="success"||typeof i=="undefined"||typeof i.responses=="undefined"||i.responses.length===0?t():s(n,i)},error:function(){t()}})}function s(n,i){var f,r,e,u;n.find(".copilot-question-input").val("");n.find(".copilot-watermark").val(i.watermark);f=n.siblings(".copilot-responses");for(const n of i.responses){r=jQuery('<div class="copilot-citations d-none"><\/div>');for(const n of i.citations)e=jQuery('<div data-id="'+n.id+'" data-title="'+n.name+'">'+n.text+"<\/div>"),r.append(e);u=jQuery('<div class="'+n.type+'">'+n.text+"<\/div>");r.children.length>0&&u.append(r);f.append(u);u[0].scrollIntoView({behavior:"smooth",block:"end"})}t()}function h(){i!==-1&&window.clearTimeout(i)}function c(n){var u=jQuery(this).attr("href"),i=jQuery(this).parents(".copilot-answer").find('.copilot-citations [data-id="'+u+'"]'),t,r;i.length!==0&&(n.preventDefault(),t=jQuery(this).parents(".copilot-wrapper").find(".copilot-citation-popup"),t.find(".modal-title").html(i.attr("data-title")),t.find(".modal-body").html(i.text()),r=new bootstrap.Modal(t),r.show())}var r=jQuery.extend({url:null,interval:2e3},n),u=jQuery(this),f=!1,i=-1;return jQuery.fn.CopilotViewer.Start=e,this.each(function(){jQuery(this).parents(".copilot-wrapper").on("click","a",c)})}})(jQuery);