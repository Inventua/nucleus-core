tinymce.util.Tools.resolve("tinymce.PluginManager").add("pages",function(n){var t=function(n){var i=document.baseURI+"User/PageSelector/Index",t;jQuery.ajax({url:i,"async":!0,method:"GET",success:function(t){jQuery(n).html(t)}});t=jQuery(".nucleus-pageselectorform");t.attr("data-target",n);t.attr("action",i);t.attr("method","POST")},i=function(){n.windowManager.open({title:"Insert Page Link",size:"medium",body:{type:"panel",items:[{type:"htmlpanel",html:'<form class="nucleus-pageselectorform"><div class="nucleus-flex-fields nucleus-pageselector"><\/div><\/form>'}]},buttons:[{type:"submit",name:"save",text:"Insert Page Link",primary:!0},{type:"cancel",name:"cancel",text:"Cancel"}],initialData:{},onSubmit:function(t){var r=jQuery(".nucleus-pageselector li.selected > a").attr("data-linkurl"),i=n.selection.getContent({format:"text"});i===""&&(i=jQuery(".nucleus-pageselector li.selected > a").html());n.insertContent('<a href="'+r+'">'+i+"<\/a>");t.close()}});t(".nucleus-pageselector")};return n.ui.registry.addButton("pages",{tooltip:"Insert Page Link",icon:"browse",onAction:function(){i()}}),{getMetadata:function(){return{name:"Insert Page Link"}}}});