/*! Plug-in that creates a list of page links based on page content.  Part of the Nucleus CMS PageLinks module.  (c) Inventua Pty Ptd.  www.nucleus-cms.com */
(function(){jQuery.fn.PageLinkViewer=function(n){function u(n,r,u){let e=n.find(":header:visible"),o=jQuery("<div><\/div>"),s=1;if(e.length>0){let h=-1,n=[];for(let c=0;c<e.length;c++){let l=e[c];if(t(l,r,u)&&(s=parseInt(l.nodeName.substring(1),10)),s!==h){if(n.length!==0){let t=i(e,o,jQuery(e[c-1]),r,u);t.append(t.is("li")?jQuery("<ol><\/ol>").append(n):n);n=[]}h=s}if(t(l,r,u)){let t=f(jQuery(l));n.push(t)}if(c===e.length-1){let t=i(e,o,jQuery(l),r,u);t.append(t.is("li")?jQuery("<ol><\/ol>").append(n):n)}}}return o.children()}function f(n){let u=n.prop("id"),f=new URL(window.location.href);f.hash="#"+u;let t=jQuery(n).attr("data-title");typeof t=="undefined"&&(t=jQuery(n).text().trim());t=t.replace("<","&lt;").replace(">","&gt;");let e=jQuery("<li><\/li>"),i=jQuery('<a href="#" title="'+t+'">'+t+"<\/a>");if(u===""){i[0].PageLinksTarget=n;i.on("click",r)}else{i.attr("href",f.toString());i.on("click",r)}return e.append(i),e}function i(n,i,r,u,f){if(n[0]===r[0])return i;else{let e=parseInt(r[0].nodeName.substring(1),10);for(let o=n.index(r);o>=0;o--){let r=n[o],s=parseInt(r.nodeName.substring(1),10);if(t(r,u,f)&&s<e){let n=null,t=new URL(window.location.href);if(t.hash="#"+jQuery(r).prop("id"),n=jQuery(i).find('a[href*="'+t.toString()+'"]').parent(),n.length!==0)return n;if(n===null||n.length===0){let n=jQuery(i).find("a");for(let t=n.length-1;t>=0;t--)if(typeof n[t].PageLinksTarget!="undefined"&&n[t].PageLinksTarget.length>0&&n[t].PageLinksTarget[0]===r)return jQuery(n[t]).parent()}}}}return i}function t(n,t,i){let r=t.toUpperCase().split(",").includes(n.nodeName);if(r){if(i==="")return!0;let t=i.split(",");for(let i=0;i<t.length;i++)if(jQuery(n).hasClass(t[i].trim().replace(/^\./gm,"")))return!0}return!1}function r(n){let t=this.PageLinksTarget;if(typeof t=="undefined"||t===null){let n=new URL(jQuery(this).attr("href"));t=jQuery(n.hash)}else n.preventDefault();let r=getComputedStyle(t[0]).getPropertyValue("--page-links-highlight-duration"),i=Number.isNaN(parseInt(r))?0:parseInt(r);i>0&&t.removeClass("pagelink-highlight").addClass("pagelink-highlight");t[0].scrollIntoView({block:"center",inline:"nearest"});i!==""&&window.setTimeout(function(){t.removeClass("pagelink-highlight")},i)}let e=jQuery.extend({},n);return this.each(function(){let n=jQuery(this);if(n[0].hasAttribute("data-page-links-rootselector")){let t=n.attr("data-page-links-rootselector"),i=n.attr("data-page-links-includeheaders"),r=n.attr("data-page-links-heading-class");n.removeAttr("data-page-links-rootselector");n.removeAttr("data-page-links-includeheaders");n.removeAttr("data-page-links-heading-class");t&&t.length!==0||(t="body");n.append(u(jQuery(t),i,r))}})}})(jQuery);