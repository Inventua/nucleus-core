/*! Plug-in that creates a list of suggestions and search results based on query.  Part of the Nucleus CMS Search module.  (c) Inventua Pty Ptd.  www.nucleus-cms.com */
(function(){jQuery.fn.SearchResults=function(n){function f(){let n=new URL(location);n.searchParams.set("search",jQuery(t+".search-term").val());window.history.replaceState({},"",n)}function e(){jQuery(document).on("click","",function(){jQuery(t+".suggestions-result").removeClass("show")});jQuery(t+".search-term").on("input",function(){return i!==-1&&window.clearTimeout(i),i=window.setTimeout(function(n){n.submit()},500,jQuery(this).parents("form").first()),!1})}function o(n,i){if(typeof i.target!="undefined"&&i.target.hasClass("search-suggestions")){try{var r=jQuery(t+" .search-term");r.length!==0&&(i.target.css("left",r.offset().left),i.target.css("max-width",r.width()*1.4))}catch(f){console.error(f)}i.target.css("margin-left","");let n=jQuery(window).width()-(i.target.offset().left+i.target.outerWidth(!0));n<0&&i.target.css("margin-left",n);i.target.collapse("show");i.target.find(".suggestions-result li").on("click",function(){let n=jQuery(this).parents("form").first().find(".search-term");n.val(jQuery(this).attr("title"));u(this)})}}function u(n){i!==-1&&window.clearTimeout(i);let r=jQuery(n).parents("form").first();return typeof r.attr("data-resultsurl")!="undefined"&&r.attr("data-resultsurl")!==""?window.location=r.attr("data-resultsurl")+"?search="+r.find(t+".search-term").val():r.find("button[type=submit").trigger("click"),!1}let r=jQuery.extend({moduleId:""},n),i=-1,t="";return this.each(function(){t="._"+r.moduleId+" ";jQuery(r.searchTermSelector).on("keydown",function(n){if(n.keyCode===13)return u(this)});jQuery(t+".search-suggestions").length!==0&&e();jQuery(Page).on("ready",function(n,t){jQuery(t.target).is(".search-suggestions")?o(n,t):f()})})}})(jQuery);